@using CarAdvertiser.Models
@model IEnumerable<CarAdvertiser.Models.SmallSearchResultViewModel>
@{
    ViewBag.Title = "MainActiveAdverts";
}

<div id="SearchResultFull">
    <table id="resultTable" class="main-active-adverts" style="padding-left: 10%; padding-right: 10%">
        <thead class="thead-dark">
            <tr>
                <th>Photo</th>
                <th>Details</th>
                <th>Description</th>
                <th>See more...</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                var base64 = Convert.ToBase64String(item.Images.First());
                var imgSrc = $"data:image/jpg;base64,{base64}";

                <tr>
                    <td style="width: 16%; padding: 10px;">
                        <img class="img-fluid" src="@imgSrc" width="320" />
                    </td>
                    <td style="width: 50%; padding: 10px;">
                        <h3>
                            <a>@Html.ActionLink(@item.Make, "AdvertSearch", "Advert")</a>
                        </h3>
                        <p></p>
                        @item.Make| @item.Model | @item.EngineSize | @item.RegYear
                        <p></p>
                        <div class="price">
                            £@item.Price
                        </div>
                    </td>
                    <td style="width: 18%; padding: 10px;">
                        @item.ShortDescription
                    </td>
                    <td style="width: 16%; padding: 10px;">
                        @if (item.IsSold)
                        {
                            <h3>SOLD</h3>
                        }
                        else
                        {
                            <a href="@Url.Action("SelectedAdvert", "Advert", new { id = item.AdvertisementId })" class="btn btn-primary">View</a>
                        }
                    </td>
                </tr>

            }
        </tbody>
    </table>
</div>
<script>
    var table = $("#resultTable").DataTable({
        "order": [[1, "asc"]],
        "paging": true,
        "searching": true,
        "bSort": true,
        "pagingType": "full_numbers",
        "columnDefs": [
            { "orderable": false, "targets": 0 },
            { "orderable": false, "targets": 3 }
            ]
    });
</script>